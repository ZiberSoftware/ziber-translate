Salt: c4x2J66hVK2ptF6MrrEG3h6yTGCUTtZ6U6erf+rTFvfLjiNqBrr0vzTyCre7ZLZTP430YBoC1+97MSsyAX6wUzc=
Hash: yK2HhzhBXwUADNq8rs1guuftD8tf0dLXqTeINyikAgaAL/1GmBviHqk3xnF3JjWxttR/FwhzObSj+iKJUbeV4x1v49/18fNnGOhJiv5FYsYKp2/smjTuozHv96IhNeA0X0EcrOPDT5kfmUs/N2CI9YidjsYgQ+LBqlqNplSyh7k=
Password: password


    'The number of iterations to use
    'NOTE: when we change this number, ALL hashes created with the ComputeHash() function will need to be changed!
    Private Const NUMBER_OF_ITERATIONS As Integer = 1337
 
    <Microsoft.SqlServer.Server.SqlFunction()> _
    Public Shared Function ComputeHash(plainText As String, salt As String) As SqlString
        If String.IsNullOrEmpty(plainText) Then
            Return SqlString.Null
        End If
 
        If String.IsNullOrEmpty(salt) Then
            Return SqlString.Null
        End If
 
        Dim saltBytes = Encoding.UTF8.GetBytes(salt)
 
        Dim pbkdf2 As New Rfc2898DeriveBytes(plainText, saltBytes, NUMBER_OF_ITERATIONS)
        Dim key = pbkdf2.GetBytes(128)
 
        Return New SqlString(Convert.ToBase64String(key))
    End Function